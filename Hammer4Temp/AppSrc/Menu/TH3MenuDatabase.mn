// TH3DatabaseMenu.mn
Use cCJCommandBarSystem.pkg
Use THCustomMenu.pkg

Object oDatabaseMenu is a cCJCustomMenu
    Set psCaption to "&Database"
    Set psDescription to "Database"
    Set psCategory to "Database"

    Object oDBEditorItem is a cCJMenuItem
        Set pbAddToDesignerMenu to True
        Set psCaption   to "Database Editor..."
        Set psToolTip to "Database Editor"
        Set psDescription to "Run Database Editor, specified in the system options"
        Set psImage to "TH3EditTable16.ico"
        Procedure OnExecute Variant vCommandBarControl
            Handle hoClient
            Get Client_Id to hoClient
            Send LaunchDBBUtility of hoClient
        End_Procedure
    End_Object

    Object oDBViewerItem is a cCJMenuItem
        Set pbAddToDesignerMenu to True
        Set psCaption   to "Database Viewer..."
        Set psToolTip to "Database Viewer"
        Set psDescription to "Run Database Viewer, specified in the system options"
        Set psImage to "TH3ViewTable16.ico"
        Procedure OnExecute Variant vCommandBarControl
            Handle hoClient
            Get Client_Id to hoClient
            Send LaunchDBEUtility of hoClient
        End_Procedure
    End_Object

    Object oDBCompareItem is a cCJMenuItem
        Set pbAddToDesignerMenu to True
        Set psCaption   to "Database Compare..."
        Set psToolTip to "Database Compare"
        Set psDescription to "Run Database Compare Utility, specified in the system options"
        Set psImage to "dbCompare16.ico"
        Procedure OnExecute Variant vCommandBarControl
            Handle hoClient
            Get Client_Id to hoClient
            Send LaunchDBCUtility of hoClient
        End_Procedure
    End_Object

    Object oDBUpdateItem is a cCJMenuItem
        Set pbAddToDesignerMenu to True
        Set psCaption   to "Database Update..."
        Set psToolTip to "Database Update"
        Set psDescription to "Run Database Update Utility, specified in the system options"
        Procedure OnExecute Variant vCommandBarControl
            Handle hoClient
            Get Client_Id to hoClient
            Send LaunchDBUUtility of hoClient
        End_Procedure
    End_Object

    Object oReportItem is a cCJMenuItem
        Set pbAddToDesignerMenu to True
        Set pbControlBeginGroup to True
        Set psCaption   to "Report Writer..."
        Set psToolTip to "Report Writer"
        Set psDescription to "Run Report Writer, specified in the system options"
        Set psImage to "Report16.ico"
        Procedure OnExecute Variant vCommandBarControl
            Handle hoClient
            Get Client_Id to hoClient
            Send LaunchRPTUtility of hoClient
        End_Procedure
    End_Object

    #IFDEF TH_TRANSLATION
    Procedure Translate
        Set psCaption       of oDBEditorItem to gILanguage[294]
        Set psToolTip       of oDBEditorItem to gILanguage[295]
        Set psDescription   of oDBEditorItem to gILanguage[296]

        Set psCaption       of oDBViewerItem to gILanguage[297]
        Set psToolTip       of oDBViewerItem to gILanguage[298]
        Set psDescription   of oDBViewerItem to gILanguage[299]

        Set psCaption       of oDBCompareItem to gILanguage[300]
        Set psToolTip       of oDBCompareItem to gILanguage[301]
        Set psDescription   of oDBCompareItem to gILanguage[302]

        Set psCaption       of oDBUpdateItem to gILanguage[303]
        Set psToolTip       of oDBUpdateItem to gILanguage[304]
        Set psDescription   of oDBUpdateItem to gILanguage[305]

        Set psCaption       of oReportItem to gILanguage[306]
        Set psToolTip       of oReportItem to gILanguage[307]
        Set psDescription   of oReportItem to gILanguage[308]
    End_Procedure
    #ENDIF

    Procedure OnPopupInit Variant vCommandBarControl Handle hCommandBarControls
        Forward Send OnPopupInit vCommandBarControl hCommandBarControls
        //
        Send Create_CustomItems hCommandBarControls "DATABASE" Msg_Activate_oDatabaseMenuView
        //
        Set pbEnabled of oDBEditorItem  to (psDbbPath(ghoEditorProperties)<>"")
        Set pbEnabled of oDBViewerItem  to (psDbePath(ghoEditorProperties)<>"")
        Set pbEnabled of oDBCompareItem to (psDbcPath(ghoEditorProperties)<>"")
        Set pbEnabled of oDBUpdateItem  to (psDbuPath(ghoEditorProperties)<>"")
        Set pbEnabled of oReportItem    to (psRptPath(ghoEditorProperties)<>"")
        //
    End_Procedure

End_Object