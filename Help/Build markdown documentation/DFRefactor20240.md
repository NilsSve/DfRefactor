# Version 2024.0

* Total revamp of the whole DataFlex refactoring concept. The old concept was way to rigid when it comes to adding new functionality and was scrapped. The new concept is centered around a **refactoring engine** (cRefactorEngine) that does the source code crunching by calling functions from the **cRefactorFuncLib** repository class. The class contains code for all refactoring functions. Every function in the **cRefactorEngine** class *must be registered* in the **Functions** data table. That registration can only be done from the **TestBench** program. **The refactoring engine uses the Functions data table to find and call refactoring functions in the cRefactorFuncLib repository.** The content from the Functions table is what is displayed in the **Function List**. Note that normal users are only expected to be running the DFRefactor program. The other two programs mentioned below are meant to be used by advanced developers only.
* The only DataFlex Studio version supported are the latest two. At current that means DataFlex 2023 and 2024. That doesn't mean that the program can't be used for projects/workspaces on earlier DataFlex versions. *All this means is that one of the last two DataFlex Studio's needs to be installed to compile and run these refactoring programs.*
* All selections made for an opened workspace are automatically preserved to the next time it is run. That counts for both selected functions and for folders for a particular opened workspace.
* **Folders list**. When a new workspace is opened and a .sws file is selected, the entire workspace is scanned for source folders. All of them are then automatically added to the **Select Folders** grid, to make easy selections from. Folders can be added/removed with the *grid's right-click context menu*. Together with the **File Filter** at the bottom left, this defines the files that will be included in the next refactoring process. All of these selection/changes are automatically saved to the database.
* Even though **it is the sole responsibility of the user to check in any source code before refactoring** with a version control software and/or making a backup of that same source code, the program is using a simple form of backup plan. The backup cycle is by default set to 14 days and can be changed from the **Program Properties** dialog. As the user is encouraged to only apply a couple of refactoring function at any time, it would be counter productive to make a new set of backup files for each run, when the **Start Refactoring** button is pressed. It would only mean that the files in the backup folders would be replaced with the most recent run and that just doesn't make sense. Instead a file is backed up the first time it is being processed, and is not touched/overwritten until the overwrite cycle has passed. This also makes it possible to undo refactoring sessions within that overwrite cycle, moving backed up files to their original folders, overwriting the refactored files.
* A opening screen is shown when the DFRefactor program is started. This is much like the Microsoft Visual Studio opening screen, where the user can select from previously opened project or to use the **Get Started** option. The selected workspace can also be changed in the DFRefactor top toolbar.
* The new TestBench program was designed to make it easier to try out the new concept and to aid when adding new refactoring functions. It is only expected to be used by very experienced developers. A small test program is automatically wrapped around the refactored file. This also makes it possible to compile to check for any obvious errors in the refactoring process. Compile errors will show up in a CodeJock toolpanel at the bottom of the program, just like in the Studio. The **Compare Code** can be used if a comparison tool has been setup in the **Program Settings** dialog.
* Unit testing is&nbsp; a central and vital part of the new refactoring concept. The new **DFUnit\_TestRunner** program consists of a series of unit tests to ensure that any edit to the cRefactorFuncLib repository does not brake anything that already existed. The cRefactorFuncLib is a subclass of the **cBasicFuncLib** class that consists of a a series of system helper functions that is used by the **cRefactorFuncLib** when creating refactoring functions. The most prominent piece of the **cBasicFuncLib** is&nbsp; the Tokenizer function. It takes one source line as input and breaks it up into a series of struct members, to be used by the refactoring functions to do their job.
* Show "bling" controls. One line near the top of the TestBench.src and DFRefactor.src can be uncommented to control two controls in the toolbar - the Theme selector and the Camera snap shot. That line is: Define CI\_ShowBlingStuff
* The only DataFlex Studio version supported are the latest two. At current that means DataFlex 2023 and 2024. That doesn't mean that the program can't be used for projects/workspaces on earlier DataFlex versions. All this means is that one of the last two DataFlex Studio's needs to be installed to compile and run the programs.
* The project was moved to GitHub: [https://github.com/NilsSve/DfRefactor](<https://github.com/NilsSve/DfRefactor>)