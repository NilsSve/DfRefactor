Use cTestFixture.pkg
Use cTest.pkg
Use cRegex.pkg
//Use cRefactorDbView.pkg
Use cRefactorFunctionLibrary.pkg

Object cRefactorDbView_Spec is a cTestFixture
    Procedure Setup
        Object oRefactorFunctionLibrary is a cRefactorFunctionLibrary
        End_Object
    End_Procedure
    
    Procedure TearDown
        Send Destroy to oRefactorFunctionLibrary
    End_Procedure

    Object oExpressionTokenizer is a cTestFixture
        
        {Published=True}
        Procedure ExpressionTokenizer_Left_1
            String sLine sExpected
            Boolean bChanged
            Move '    If (iA > iB) Move (Trim (Customer.Zip) * Trim (Customer.City)) to sReply' to sLine
            Move '(iA > iB)' to sExpected
            Get _ExpressionExtractor of ghoRefactorFunctionLibrary sLine CI_LeftExpression to sLine
            Send Assert True
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure ExpressionTokenizer_Left_2
            String sLine sExpected
            Boolean bChanged
            Move '    While (iA > iB)' to sLine
            Move '(iA > iB)' to sExpected
            Get _ExpressionExtractor of ghoRefactorFunctionLibrary sLine CI_LeftExpression to sLine
            Send Assert True
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure ExpressionTokenizer_To_1
            String sLine sExpected
            Boolean bChanged
            Move '    If (iA > iB) Move (Trim (Customer.Zip) * Trim (Customer.City)) to (Main_DD(Self))' to sLine
            Move '(Main_DD(Self))' to sExpected
            Get _ExpressionExtractor of ghoRefactorFunctionLibrary sLine CI_ToTexpression to sLine
            Send Assert True
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure ExpressionTokenizer_To_2
            String sLine sExpected
            Boolean bChanged
            Move '    Set Value of (oMain(Current_Object)) to (Left(sOutConnStr, iStart - 1))' to sLine
            Move '(Left(sOutConnStr, iStart - 1))' to sExpected
            Get _ExpressionExtractor of ghoRefactorFunctionLibrary sLine CI_ToTexpression to sLine
            Send Assert True
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure ExpressionTokenizer_To_Null
            String sLine sExpected
            Boolean bChanged
            Move '    If (iA > iB) Move (Trim (Customer.Zip) * Trim (Customer.City)) to sRetval' to sLine
            Move '' to sExpected
            Get _ExpressionExtractor of ghoRefactorFunctionLibrary sLine CI_ToTexpression to sLine
            Send Assert True
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ExpressionTokenizer_Of_1
            String sLine sExpected
            Boolean bChanged
            Move '    Set Value of (oMain(Current_Object)) to (Left(sOutConnStr, iStart - 1))' to sLine
            Move '(oMain(Current_Object))' to sExpected
            Get _ExpressionExtractor of ghoRefactorFunctionLibrary sLine CI_OfExpression to sLine
            Send Assert True
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ExpressionTokenizer_Of_2
            String sLine sExpected
            Boolean bChanged
            Move '    Set Value of oMain to (Left(sOutConnStr, iStart - 1))' to sLine
            Move '' to sExpected
            Get _ExpressionExtractor of ghoRefactorFunctionLibrary sLine CI_OfExpression to sLine
            Send Assert True
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object
    
    Object oRemoveOldStudioMarkers is a cTestFixture
        
        {Published=True}
        Procedure RemoveOldStudioMarkers_AB_IgnoreStart
            String sLine sExpected
            Boolean bChanged
            Move '//AB-IgnoreStart' to sLine
            Move '//AB-IgnoreStart' to sExpected
            // Returns True if a legacy IDE (Studio) source code marker is found, and
            // in case the source line should be removed.
            Get RemoveOldStudioMarkers of ghoRefactorFunctionLibrary (&sLine) to bChanged      
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_AB_DDOEnd
            String sLine sExpected
            Boolean bChanged
            Move '//AB-DDOEnd' to sLine
            Move '//AB-DDOEnd' to sExpected
            Get RemoveOldStudioMarkers of ghoRefactorFunctionLibrary (&sLine) to bChanged      
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_PanelStoreTopStart
            String sLine sExpected
            Boolean bChanged
            Move '  //AB-PanelStoreTopStart' to sLine
            Move '  //AB-PanelStoreTopStart' to sExpected
            Get RemoveOldStudioMarkers of ghoRefactorFunctionLibrary (&sLine) to bChanged      
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_AB_Comment
            String sLine sExpected
            Boolean bChanged
            Move '  //AB/ ' to sLine
            Move '  //AB/ ' to sExpected
            Get RemoveOldStudioMarkers of ghoRefactorFunctionLibrary (&sLine) to bChanged      
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_IDE_FileType
            String sLine sExpected
            Boolean bChanged
            Move '//IDE-FileType=ftApplication' to sLine
            Move '//IDE-FileType=ftApplication' to sExpected
            Get RemoveOldStudioMarkers of ghoRefactorFunctionLibrary (&sLine) to bChanged      
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object
    
    Object ChangeUClassToRefClass_Fixture is a cTestFixture
        
        {Published=True}
        Procedure SimpleTest
            String sLine sExpected
            Boolean bChanged
            Move "    Get Create U_Array to hArray" to sLine
            Move "    Get Create (RefClass(Array)) to hArray" to sExpected
            Get ChangeUClassToRefClass of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure ManySpaces
            String sLine sExpected
            Boolean bChanged
            Move "    Get    Create   U_Array    to     hArray" to sLine
            Move "    Get    Create   (RefClass(Array))    to     hArray" to sExpected
            Get ChangeUClassToRefClass of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object
    
    Object ChangeInToContains_Fixture is a cTestFixture

        {Published=True}
        Procedure IndicateIn_Test
            String sLine sExpected
            Boolean bChanged
            Move '    indicate Select as sSubString in sHostString // Comment' to sLine
            Move '    indicate Select as (sHostString contains sSubString) // Comment' to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure IfIn_Test
            String sLine sExpected
            Boolean bChanged
            Move '    if sSubString in sHostString RunProgram' to sLine
            Move '    if (sHostString contains sSubString) RunProgram' to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure UntilIn_Test
            String sLine sExpected
            Boolean bChanged
            Move 'Until sSubString in sHostString' to sLine
            Move 'Until (sHostString contains sSubString)' to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure WhileIn_Test
            String sLine sExpected
            Boolean bChanged
            Move 'While sSubString in sHostString' to sLine
            Move 'While (sHostString contains sSubString)' to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        // This test will fail because the logic assumes the source line to be of proper syntax,
        // e.g. it needs to start with a command (or indicator + command).
        {Published=False}
        Procedure SpacesAroundIn_Test
            String sLine sExpected
            Boolean bChanged
            Move '     sSubString    in     sHostString    ' to sLine
            Move '     (sHostString contains sSubString)    ' to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure ConstantStringIn_Test
            String sLine sExpected
            Boolean bChanged
            Move 'if "." in a_number' to sLine
            Move 'if (a_number contains ".")' to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure ConstantStringIn2_Test
            String sLine sExpected
            Boolean bChanged
            Move 'if "." in "12.12"' to sLine
            Move 'if ("12.12" contains ".")' to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure SingleQuoteInConstantString_Test
            String sLine sExpected
            Boolean bChanged
            Move (Replaces('`', 'if "`" in "I`m okay"', "'")) to sLine
            Move (Replaces('`', 'if ("I`m okay" contains "`")', "'")) to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure DoubleQuoteInConstantString_Test
            String sLine sExpected
            Boolean bChanged
            Move (Replaces('`', 'if "`" in "I`m okay"', "'")) to sLine
            Move (Replaces('`', 'if ("I`m okay" contains "`")', "'")) to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure CrLfInConstantString_Test
            String sLine sExpected
            Boolean bChanged
            // If (Character(10)) in sValue Command
            Move "If (Character(10)) in sValue RunProgram" to sLine
            Move "If (sValue contains (Character(10))) RunProgram" to sExpected
            Get ChangeInToContains of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    End_Object
    
    Object GetAddress_Fixture is a cTestFixture
        
        {Published=True}
        Procedure Default_Test
            String sLine sExpected
            Boolean bChanged
            Move "    GetAddress of sString to pString" to sLine
            Move "    Move (AddressOf(sString)) to pString" to sExpected
            Get ChangeGetAddress of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure Do_not_Change_function_test
            String sLine sExpected
            Boolean bChanged
            Move " Function GetAddress Returns String" to sLine
            Move " Function GetAddress Returns String" to sExpected
            Get ChangeGetAddress of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure Do_not_Change_function_invocation_Test
            String sLine sExpected
            Boolean bChanged
            Move " Entry_Item (GetAddress(oCustomer_DD))" to sLine
            Move " Entry_Item (GetAddress(oCustomer_DD))" to sExpected
            Get ChangeGetAddress of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure Do_not_Change_Address_In_A_Comment_Test
            String sLine sExpected
            Boolean bChanged
            Move "String structBytesRead      //Actual bytes read - Should be integer but getAddress cannot find " to sLine
            Move "String structBytesRead      //Actual bytes read - Should be integer but getAddress cannot find " to sExpected
            Get ChangeGetAddress of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
    End_Object
    
    Object LegacyOperators_Fixture is a cTestFixture
        
        {Published=True}
        Procedure Default_Test
            String sLine sExpected
            Boolean bChanged
            Move " If sTmp NE '' Begin" to sLine
            Move " If (sTmp <> '') Begin" to sExpected
            Get ChangeLegacyOperators of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure Indicator_With_Legacy_Op
            String sLine sExpected
            Boolean bChanged
            Move "  [Select] Indicate Select as Windowindex Eq Fieldindex // Comment" to sLine
            Move "  [Select] Indicate Select as (Windowindex = Fieldindex) // Comment" to sExpected
            Get ChangeLegacyOperators of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure If_And_Add_With_Legacy_Op
            String sLine sExpected
            Boolean bChanged
            Move '  If ((mid(sRowX,1,iPosX)) eq ",") Add 1 to iCommasX // Comment' to sLine
            Move '  If ((mid(sRowX,1,iPosX)) = ",") Add 1 to iCommasX // Comment' to sExpected
            Get ChangeLegacyOperators of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure Do_Not_Change_Legacy_Op_In_Comment
            String sLine sExpected
            Boolean bChanged
            Move " Move sFoo to sBar // Not exactly what NE has in mind" to sLine
            Move " Move sFoo to sBar // Not exactly what NE has in mind" to sExpected
            Get ChangeLegacyOperators of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure Do_Not_Change_Legacy_Op_After_End_Comment
            String sLine sExpected
            Boolean bChanged
            Move '  End // If Maskiner.mnr Eq Jobbhist.mnr Begin' to sLine
            Move '  End // If Maskiner.mnr Eq Jobbhist.mnr Begin' to sExpected
            Get ChangeLegacyOperators of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
    End_Object
    
    Object LegacyTrim_Command is a cTestFixture
        
        {Published=True}
        Procedure Default_Test
            String sLine sExpected
            Boolean bChanged
            Move " Trim sTmp to sValue" to sLine
            Move " Move (Trim(sTmp)) to sValue" to sExpected
            Get ChangeTrimCommandToFunction of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure Do_not_change_Comment_trim
            String sLine sExpected
            Boolean bChanged
            Move " Move sTmp to sValue // That's mighty trim of you" to sLine
            Move " Move sTmp to sValue // That's mighty trim of you" to sExpected
            Get ChangeTrimCommandToFunction of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object
    
    Object x_RemoveLeft_Function is a cTestFixture
        
        {Published=True}
        Procedure Select_Test
            String sLine sExpected
            Boolean bChanged
            Move "  [Not Select] Move (Trim(sTmp)) to sValue // End comment" to sLine
            Move "Move (Trim(sTmp)) to sValue // End comment" to sExpected
            Get _RemoveLeft of ghoRefactorFunctionLibrary "Select] " (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
        
        {Published=True}
        Procedure Do_not_change_Comment_trim
            String sLine sExpected
            Boolean bChanged
            Move "  'This is an example' // Some comment" to sLine
            Move "is an example' // Some comment" to sExpected
            Get _RemoveLeft of ghoRefactorFunctionLibrary "is " (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
        {Published=True}
        Procedure Double_Logical
            String sLine sExpected
            Boolean bChanged
            Move "  Move (not(bState) to bState // Some comment" to sLine
            Move "bState) to bState // Some comment" to sExpected
            Get _RemoveLeft of ghoRefactorFunctionLibrary "Move (not(" (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
        {Published=True}
        Procedure RemoveTo_to
            String sLine sExpected
            Boolean bChanged
            Move "  Move (not(bState) to bState // Some comment" to sLine
            Move "to bState // Some comment" to sExpected
            Get _RemoveLeft of ghoRefactorFunctionLibrary "bState) " (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
        {Published=True}
        Procedure Remove_of
            String sLine sExpected
            Boolean bChanged
            Move "  Set Shadow_State of (oApplication(Self)) to False // Comment here" to sLine
            Move " (oApplication(Self)) to False // Comment here" to sExpected
            Get _RemoveLeft of ghoRefactorFunctionLibrary "  Set Shadow_State of" (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
        {Published=True}
        Procedure Remove_oApplication
            String sLine sExpected
            Boolean bChanged
            Move "  Set Shadow_State of (oApplication(Self)) to False // Comment here" to sLine
            Move "(Self)) to False // Comment here" to sExpected
            Get _RemoveLeft of ghoRefactorFunctionLibrary "oApplication" (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
        {Published=True}
        Procedure Remove_Nothing
            String sLine sExpected
            Boolean bChanged
            Move "  Set Shadow_State of (oApplication(Self)) to False // Comment here" to sLine
            Move "  Set Shadow_State of (oApplication(Self)) to False // Comment here" to sExpected
            Get _RemoveLeft of ghoRefactorFunctionLibrary "Enabled_State" (&sLine) to bChanged
    
            Send Assert (Not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure
    
    End_Object      
    
    Object oChangeIndicatorToIfBegin is a cTestFixture

        {Published=True}
        Procedure Change_Indicator_to_If_Begin
            String sLine sExpected
            Boolean bChanged
            Move "  [not Seqeof] Begin // Comment" to sLine
            Move "  If (Seqeof = False) Begin // Comment" to sExpected
            Get ChangeIndicatorToIfBegin of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeReplaceCommandToFunction is a cTestFixture
        
        {Published=True}
        Procedure Change_Replace_Command_To_Function
            String sLine sExpected
            Boolean bChanged
            Move '  Replace  "A"  In  sNameX  With "B" // End comment' to sLine
            Move '  Move (Replace("A", sNameX, "B")) to sNameX // End comment' to sExpected
            Get ChangeReplaceCommandToFunction of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object
    
    Object oChangewsDoTranslateTo_ is a cTestFixture
        
        {Published=True}
        Procedure ChangewsDoTranslateTo_Function
            String sLine sExpected
            Boolean bChanged
            Move '  Function_Return (wsDoTranslate(Self,3713,"Januari"))' to sLine
            Move '  Function_Return (_("Januari"))' to sExpected
            Get ChangewsDoTranslateTo_ of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangewsDoTranslateTo_FunctionName
            String sLine sExpected
            Boolean bChanged
            Move '  Function wsDoTranslate Integer iTextNo String sMenu Returns String' to sLine
            Move '  Function wsDoTranslate Integer iTextNo String sMenu Returns String' to sExpected
            Get ChangewsDoTranslateTo_ of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangewsDoTranslateTo_InStringValue
            String sLine sExpected
            Boolean bChanged
            Move '  // Send Stop_box (wsDoTranslate(Self,3837,"Var god anv„nd knappen Nummerbyte f”r att byta id"))' to sLine
            Move '  // Send Stop_box (wsDoTranslate(Self,3837,"Var god anv„nd knappen Nummerbyte f”r att byta id"))' to sExpected
            Get ChangewsDoTranslateTo_ of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangewsDoTranslateTo_Confirm
            String sLine sExpected
            Boolean bChanged
            Move '  Get Confirm (wsDoTranslate(Self,1986,"Start")) to iRetVal' to sLine
            Move '  Get Confirm (_("Start")) to iRetVal' to sExpected
            Get ChangewsDoTranslateTo_ of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangewsDoTranslateTo_WithinExpression
            String sLine sExpected
            Boolean bChanged
            Move '  Append sErrMess ("-" + wsDoTranslate(Self,2941,"Du f†r inte boka av serviceorder. Kunden „r ett prospekt") + "\n")' to sLine
            Move '  Append sErrMess ("-" + _("Du f†r inte boka av serviceorder. Kunden „r ett prospekt") + "\n")' to sExpected
            Get ChangewsDoTranslateTo_ of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangewsDoTranslateTo_Double
            String sLine sExpected
            Boolean bChanged
            Move '  Append sText (wsDoTranslate(Self,678,"Kreditsaldo h”gre „n kreditgr„ns")) "  " (wsDoTranslate(Self,678,"Forts„tt registrera order?"))' to sLine
            Move '  Append sText (_("Kreditsaldo h”gre „n kreditgr„ns")) "  " (_("Forts„tt registrera order?"))' to sExpected
            Get ChangewsDoTranslateTo_ of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure   
        
        {Published=True}
        Procedure ChangewsDoTranslateTo_SendLogg
            String sLine sExpected
            Boolean bChanged
            Move '  Send Logg (wsDoTranslate(Self,2686,"Baskundnr saknas!"))' to sLine
            Move '  Send Logg (_("Baskundnr saknas!"))' to sExpected
            Get ChangewsDoTranslateTo_ of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure   

    End_Object
    
    Object oChangeLegacyShadow_State is a cTestFixture
        
        {Published=True}
        Procedure ChangeLegacyShadow_State_BaseTest
            String sLine sExpected
            Boolean bChanged
            Move '  Set Shadow_State of (oApplication(Self)) to False // Comment here' to sLine
            Move '  Set Enabled_State of (oApplication(Self)) to True // Comment here' to sExpected
            Get ChangeLegacyShadow_State of ghoRefactorFunctionLibrary (&sLine) to bChanged      
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_GetTest
            String sLine sExpected
            Boolean bChanged
            Move '  Get Shadow_State to bState // Other comment' to sLine
            Move '  Get Enabled_State to (Not(bState)) // Other comment' to sExpected
            Get ChangeLegacyShadow_State of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_SetFalse
            String sLine sExpected
            Boolean bChanged
            Move '  Set Shadow_State of oButton to (not(bState))' to sLine
            Move '  Set Enabled_State of oButton to bState' to sExpected
            Get ChangeLegacyShadow_State of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacy_Object_Shadow_State
            String sLine sExpected
            Boolean bChanged
            Move '  Set Object_Shadow_state to True' to sLine
            Move '  Set Enabled_State to False' to sExpected
            Get ChangeLegacyShadow_State of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveLocalKeyWord is a cTestFixture
        
        {Published=True}
        Procedure RemoveLocalKeyWord_Basic
            String sLine sExpected
            Boolean bChanged
            Move '  Local Integer iRename' to sLine
            Move '  Integer iRename' to sExpected
            Get RemoveLocalKeyWord of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveLocalKeyWord_After_Comment_Characters
            String sLine sExpected
            Boolean bChanged
            Move '  // Local Integer iRename' to sLine
            Move '  // Local Integer iRename' to sExpected
            Get RemoveLocalKeyWord of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveLocalKeyWord_In_Comment
            String sLine sExpected
            Boolean bChanged
            Move '  "Local Integer iRename"' to sLine
            Move '  "Local Integer iRename"' to sExpected
            Get RemoveLocalKeyWord of ghoRefactorFunctionLibrary (&sLine) to bChanged
    
            Send Assert (not(bChanged))
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    
End_Object
