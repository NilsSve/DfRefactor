Use cRefactorFuncLib.pkg

Object cRefactorFuncLib_Tests is a cTestFixture
    Set psFunctionName to "Main Test Fixture Object"

        Procedure Setup
        End_Procedure

        // Reinitialize base class properties for each cTestFixture object procedure call.
        Procedure TearDown        
            Send InitializeInterface of ghoRefactorFuncLib
        End_Procedure

    // *** cTestFixture objects below: ***
    //
    Object oChangeCurrent_ObjectToSelf is a cTestFixture
        Set psFunctionName to "ChangeCurrent_ObjectToSelf"

        {Published=True}
        Procedure ChangeCurrent_ObjectToSelf_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move (piCurrentRow(Current_Object)) to iRow' to sLine
            Move 'Move (piCurrentRow(Self)) to iRow' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCurrent_ObjectToSelf of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeCurrent_ObjectToSelf_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move (piCurrentRow(Current_Object)) to (phoTestHandle(Current_Object))' to sLine
            Move 'Move (piCurrentRow(Self)) to (phoTestHandle(Self))' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCurrent_ObjectToSelf of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeCurrent_ObjectToSelf_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    Move OG_Current_Object to WindowIndex // not current_object' to sLine
            Move '    Move OG_Current_Object to WindowIndex // not current_object' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCurrent_ObjectToSelf of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeDfTrueDfFalse is a cTestFixture
        Set psFunctionName to "ChangeDfTrueDfFalse"

        {Published=True}
        Procedure ChangeDfTrueDfFalse_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move DFTrue to Found' to sLine
            Move 'Move True to Found' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeDfTrueDfFalse of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeDfTrueDfFalse_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If ((Left(sRow,1)) ne "#") Move dfFalse to bRename' to sLine
            Move 'If ((Left(sRow,1)) ne "#") Move False to bRename' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeDfTrueDfFalse of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeLegacyIndicators is a cTestFixture
        Set psFunctionName to "ChangeLegacyIndicators"

        {Published=True}
        Procedure ChangeLegacyIndicators_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Indicate Found as True' to sLine
            Move 'Move (True) to Found' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Indicate [Found] as True' to sLine
            Move 'Move (True) to Found' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [Select] Indicate Select as WindowIndex Eq FieldIndex' to sLine
            Move '   If (Select) Move (WindowIndex Eq FieldIndex) to Select' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [Not Found] Indicate Select as WindowIndex Eq FieldIndex' to sLine
            Move '   If (Not(Found)) Move (WindowIndex Eq FieldIndex) to Select' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_5
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    Indicate Select as Windowindex Eq Fieldindex // Comment" to sLine
            Move "    Move (Windowindex Eq Fieldindex) to Select // Comment" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_6
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    If [False] Indicate Select as Windowindex Eq Fieldindex // Comment" to sLine
            Move "    If (False) Move (Windowindex Eq Fieldindex) to Select // Comment" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_7
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    If [False] Move (Windowindex Eq Fieldindex) to Select // Comment" to sLine
            Move "    If (False) Move (Windowindex Eq Fieldindex) to Select // Comment" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_8
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [Found] Reread // End comment' to sLine
            Move '   If (Found) Reread // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged 
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_9
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [not found]   reread' to sLine
            Move '   If (not(found)) reread' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_10
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [Not Found] Move iA to iB // End comment' to sLine
            Move '   If (Not(Found)) Move (iA) to iB // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_11
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [Found] Repeat // End comment' to sLine
            Move '   While (Found) // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_13
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [not Seqeof] Repeat // End comment' to sLine
            Move '   While (not(Seqeof)) // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_14
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [not Found] Repeat // End comment' to sLine
            Move '   While (not(Found)) // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_15
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [Found] Loop // End comment' to sLine
            Move '   Loop // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_16
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [not Seqeof] Loop // End comment' to sLine
            Move '   Loop // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_17
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [Select] Until [Found] // End comment' to sLine
            Move '   Until (Found) // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_18
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [not Found] While // End comment' to sLine
            Move '   While (not(Found)) // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_19
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   While [not Found] // End comment' to sLine
            Move '   While (not(Found)) // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_20
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   [not Found] Reread // End comment' to sLine
            Move '   If (not(Found)) Reread // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_21
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Constrain FlexErrs.Recnum gt 10 // End comment' to sLine
            Move '   Constrain FlexErrs.Recnum gt 10 // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_22
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    [Found] Delete hTable // End comment' to sLine
            Move '    If (Found) Delete hTable // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_23
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    [Not MyBoolean] Begin' to sLine
            Move '    If (Not(MyBoolean)) Begin' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_24
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    [Found ~Found] Begin' to sLine
            Move '    If (Found and Not(Found)) Begin' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_25
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    [FindErr]  Move ( _("L”senordet m†ste uppfylla f”ljande villkor") + ":\n\n" + ;' to sLine
            Move '    If (FindErr) Move ( _("L”senordet m†ste uppfylla f”ljande villkor") + ":\n\n" + ;' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyIndicators_26
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    [~Debits] Begin' to sLine
            Move '    If (Not(Debits)) Begin' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyIndicators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeGetAddress is a cTestFixture
        Set psFunctionName to "ChangeGetAddress"

        {Published=True}
        Procedure GetAddress_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    GetAddress of sString to pMyPointer" to sLine
            Move "    Move (AddressOf(sString)) to pMyPointer" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeGetAddress of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure GetAddress_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move " Function GetAddress Returns String" to sLine
            Move " Function GetAddress Returns String" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeGetAddress of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure GetAddress_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move " Entry_Item (GetAddress(oCustomer_DD))" to sLine
            Move " Entry_Item (GetAddress(oCustomer_DD))" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeGetAddress of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure GetAddress_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "String structBytesRead      //Actual bytes read - Should be integer but getAddress cannot find " to sLine
            Move "String structBytesRead      //Actual bytes read - Should be integer but getAddress cannot find " to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeGetAddress of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeInToContains is a cTestFixture
        Set psFunctionName to "ChangeInToContains"

        {Published=True}
        Procedure ChangeInToContains_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    indicate Select as sSubString in sHostString // Comment' to sLine
            Move '    indicate Select as (sHostString contains sSubString) // Comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData  
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    if sSubString in sHostString RunProgram' to sLine
            Move '    if (sHostString contains sSubString) RunProgram' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Until sSubString in sHostString' to sLine
            Move 'Until (sHostString contains sSubString)' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'While sSubString in sHostString' to sLine
            Move 'While (sHostString contains sSubString)' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        // This test will fail because the logic assumes the source line to be of proper syntax,
        // e.g. it needs to start with a command (or indicator + command).
        {Published=True}
        Procedure ChangeInToContains_5
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    If sSubString    in     sHostString Move True to bFound' to sLine
            Move '    If (sHostString contains sSubString) Move True to bFound' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_6
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'if "." in a_number Move "A" to "B"' to sLine
            Move 'if (a_number contains ".") Move "A" to "B"' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_7
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'if "." in "12.12"' to sLine
            Move 'if ("12.12" contains ".")' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_8
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move (Replaces('`', 'if "`" in "I`m okay"', "'")) to sLine
            Move (Replaces('`', 'if ("I`m okay" contains "`")', "'")) to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_9
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move (Replaces('`', 'if "`" in "I`m okay"', "'")) to sLine
            Move (Replaces('`', 'if ("I`m okay" contains "`")', "'")) to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_10
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "If (Character(10)) in sValue RunProgram" to sLine
            Move "If (sValue contains (Character(10))) RunProgram" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInToContains_11
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If "Support Classes" in sShow Set pbDontShowMNS of (VDFCLS_DD(Self)) to True' to sLine
            Move 'If (sShow contains "Support Classes") Set pbDontShowMNS of (VDFCLS_DD(Self)) to True' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInToContains of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeLegacyOperators is a cTestFixture
        Set psFunctionName to "ChangeLegacyOperators"

        {Published=True}
        Procedure ChangeLegacyOperators_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    While ((Found eq True) and (iA Eq iB))" to sLine
            Move "    While ((Found = True) and (iA = iB))" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    While iL lt 13" to sLine
            Move "    While (iL < 13)" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure  
        
        {Published=True}
        Procedure ChangeLegacyOperators_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    Send Find to Self EQ 1" to sLine
            Move "    Send Find to Self EQ 1" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure  

        {Published=True}
        Procedure ChangeLegacyOperators_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If iParXt_Next Eq 0 Move "to"   to sLabel' to sLine
            Move 'If (iParXt_Next = 0) Move "to" to sLabel' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure  
                     
        {Published=True}
        Procedure ChangeLegacyOperators_5
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If iA eq iB Move (Trim (FlexErrs.Error_Descr) * Trim (Flexerrs.Note)) to vData[iRow][2] // Name: ZipCode_City, Length: 100, Datatype: String' to sLine
            Move 'If (iA = iB) Move (Trim (FlexErrs.Error_Descr) * Trim (Flexerrs.Note)) to vData[iRow][2] // Name: ZipCode_City, Length: 100, Datatype: String' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure                       

        {Published=True}
        Procedure ChangeLegacyOperators_6
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Constrain FlexErrs.Recnum gt 10' to sLine
            Move 'Constrain FlexErrs.Recnum gt 10' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure                       

        {Published=True}
        Procedure ChangeLegacyOperators_7
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    If d Gt  2 Begin' to sLine
            Move '    If (d > 2) Begin' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_8
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    If d Eq   1 Begin' to sLine
            Move '    If (d = 1) Begin' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_9
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '     If (Found) Move (WindowIndex eq FieldIndex) to Found' to sLine
            Move '     If (Found) Move (WindowIndex = FieldIndex) to Found' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_10
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '     If (MyFunction(self,iRow)) eq sValue Function_Return iRow' to sLine
            Move '     If ((MyFunction(self,iRow)) = sValue) Function_Return iRow' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_11
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '     If lsDriver eq "ODBC_DRV" Function_Return ""' to sLine
            Move '     If (lsDriver = "ODBC_DRV") Function_Return ""' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_12
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '     If row# eq -1 Move "Unknown" to value# // This one is ok' to sLine
            Move '     If (row# = -1) Move "Unknown" to value# // This one is ok' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_13
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '     If ((Current_Radio(Self)) eq 0) Move (Append("W",(Value(oWorkspace(Self),0)))) to retval' to sLine
            Move '     If ((Current_Radio(Self)) = 0) Move (Append("W",(Value(oWorkspace(Self),0)))) to retval' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_14
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '         If iArg eq 1 Send Anything' to sLine
            Move '         If (iArg = 1) Send Anything' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyOperators_15
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    If code# eq 0 If tmp# ge 0 Move (rval#+tmp#) to rval#' to sLine
            Move '    If (code# = 0) If (tmp# >= 0) Move (rval#+tmp#) to rval#' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyOperators of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure  
        
    End_Object

    Object oChangeLegacyShadow_State is a cTestFixture
        Set psFunctionName to "ChangeLegacyShadow_State"

        {Published=True}
        Procedure ChangeLegacyShadow_State_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Set Shadow_State of (oApplication(Self)) to False  // Comment here' to sLine
            Move '   Set Enabled_State of (oApplication(Self)) to True // Comment here' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyShadow_State of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Get Shadow_State to bState   // Other comment' to sLine
            Move '   Get Enabled_State to (Not(bState)) // Other comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyShadow_State of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Set Shadow_State of oButton to (not(bState))' to sLine
            Move '   Set Enabled_State of oButton to bState' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyShadow_State of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Set Object_Shadow_state to True' to sLine
            Move '   Set Enabled_State to False' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyShadow_State of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_5
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Set Shadow_State of oButton to (not(bState)) // End comment' to sLine
            Move '   Set Enabled_State of oButton to bState // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyShadow_State of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_6
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '        Set Shadow_State of oButton to (not(bState))' to sLine
            Move '        Set Enabled_State of oButton to bState' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyShadow_State of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLegacyShadow_State_7
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '        Set object_shadow_state of (oBtn1(self)) to (not(liLogImage))' to sLine
            Move '        Set Enabled_State of (oBtn1(self)) to liLogImage' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLegacyShadow_State of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeReplaceCommandToFunction is a cTestFixture
        Set psFunctionName to "ChangeReplaceCommandToFunction"

        {Published=True}
        Procedure ChangeReplaceCommandToFunction_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  Replace  "A"  In  sNameX  With "B" // End comment' to sLine
            Move '  Move (Replace("A",sNameX,"B")) to sNameX // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeReplaceCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeTrimCommandToFunction is a cTestFixture
        Set psFunctionName to "ChangeTrimCommandToFunction"

        {Published=True}
        Procedure ChangeTrimCommandToFunction_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move " Trim sTmp to sValue" to sLine
            Move " Move (Trim(sTmp)) to sValue" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeTrimCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeTrimCommandToFunction_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move " Move sTmp to sValue // That's mighty trim of you" to sLine
            Move " Move sTmp to sValue // That's mighty trim of you" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeTrimCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeTrimCommandToFunction_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move " If iA gt iB Trim sTmp to sValue" to sLine
            Move " If iA gt iB Move (Trim(sTmp)) to sValue" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeTrimCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeUClassToRefClass_Fixture is a cTestFixture
        Set psFunctionName to "ChangeUClassToRefClass"

        {Published=True}
        Procedure ChangeUClassToRefClass_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    Get Create U_Array to hArray" to sLine
            Move "    Get Create (RefClass(Array)) to hArray" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeUClassToRefClass of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeUClassToRefClass_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "    Get    Create   U_Array    to     hArray" to sLine
            Move "    Get    Create   (RefClass(Array))    to     hArray" to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeUClassToRefClass of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveLocalKeyWord is a cTestFixture
        Set psFunctionName to "RemoveLocalKeyWord"

        {Published=True}
        Procedure RemoveLocalKeyWord_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  Local Integer iRename' to sLine
            Move '  Integer iRename' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveLocalKeyWord of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveLocalKeyWord_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  // Local Integer iRename' to sLine
            Move '  // Local Integer iRename' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveLocalKeyWord of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveLocalKeyWord_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  "Local Integer iRename"' to sLine
            Move '  "Local Integer iRename"' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveLocalKeyWord of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveLocalKeyWord_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  Local String[] asData' to sLine
            Move '  String[] asData' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveLocalKeyWord of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveOldStudioMarkers is a cTestFixture
        Set psFunctionName to "RemoveOldStudioMarkers"

        {Published=True}
        Procedure RemoveOldStudioMarkers_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '//AB-IgnoreStart' to sLine
            Move '//AB-IgnoreStart' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            // Returns True if a legacy IDE (Studio) source code marker is found, and
            // in case the source line should be removed.
            Get RemoveOldStudioMarkers of ghoRefactorFuncLib (&sLine) to bChanged
            If (bChanged = False) Begin
                Move "" to sLine
            End
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '//AB-DDOEnd' to sLine
            Move '//AB-DDOEnd' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveOldStudioMarkers of ghoRefactorFuncLib (&sLine) to bChanged
            If (bChanged = False) Begin
                Move "" to sLine
            End
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  //AB-PanelStoreTopStart' to sLine
            Move '  //AB-PanelStoreTopStart' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveOldStudioMarkers of ghoRefactorFuncLib (&sLine) to bChanged
            If (bChanged = False) Begin
                Move "" to sLine
            End
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  //AB/ ' to sLine
            Move '  //AB/ ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveOldStudioMarkers of ghoRefactorFuncLib (&sLine) to bChanged
            If (bChanged = False) Begin
                Move "" to sLine
            End
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveOldStudioMarkers_5
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '//IDE-FileType=ftApplication' to sLine
            Move '//IDE-FileType=ftApplication' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveOldStudioMarkers of ghoRefactorFuncLib (&sLine) to bChanged
            If (bChanged = False) Begin
                Move "" to sLine
            End
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeInsertCommandToFunction is a cTestFixture
        Set psFunctionName to "ChangeInsertCommandToFunction"

        {Published=True}
        Procedure ChangeInsertCommandToFunction_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move ' If sOne Eq "A" Insert "B" in sOne at 2' to sLine
            Move ' If sOne Eq "A" Move (Insert("B",sOne,2)) to sOne' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInsertCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeInsertCommandToFunction_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Insert "   " in sVar at 2' to sLine
            Move '   Move (Insert("   ",sVar,2)) to sVar' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInsertCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure  
        
        {Published=True}
        Procedure ChangeInsertCommandToFunction_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   Replace sChr In sTag with (uppercase(sChr))' to sLine
            Move '   Replace sChr In sTag with (uppercase(sChr))' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeInsertCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure  
        
    End_Object

    Object oChangeLengthCommandToFunction is a cTestFixture
        Set psFunctionName to "ChangeLengthCommandToFunction"

        {Published=True}
        Procedure ChangeLengthCommandToFunction_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Length sVar to iLength' to sLine
            Move 'Move (Length(sVar)) to iLength' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLengthCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLengthCommandToFunction_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   If iA EQ iB Length sVar to iLength' to sLine
            Move '   If iA EQ iB Move (Length(sVar)) to iLength' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLengthCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeLengthCommandToFunction_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   If (Found) Length sVar to iLength // End comment' to sLine
            Move '   If (Found) Move (Length(sVar)) to iLength // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeLengthCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangePosCommandToFunction is a cTestFixture
        Set psFunctionName to "ChangePosCommandToFunction"

        {Published=True}
        Procedure ChangePosCommandToFunction_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Pos "-"  in sIns to iPos' to sLine
            Move 'Move (Pos("-",sIns)) to iPos' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangePosCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangePosCommandToFunction_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '   If (iA <> iB) Pos "   "  in sIns to iPos // End comment' to sLine
            Move '   If (iA <> iB) Move (Pos("   ",sIns)) to iPos // End comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangePosCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeSysdate4 is a cTestFixture
        Set psFunctionName to "ChangeSysdate4"

        {Published=True}
        Procedure ChangeSysdate4_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Sysdate4 dToday' to sLine
            Move 'Sysdate dToday' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeSysdate4 of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeZeroStringCommandToFunction is a cTestFixture
        Set psFunctionName to "ChangeZeroStringCommandToFunction"

        {Published=True}
        Procedure ChangeZeroStringCommandToFunction_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'ZeroString iLength to sParameter' to sLine
            Move 'Move (ZeroString(iLength)) to sParameter' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeZeroStringCommandToFunction of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oEditorDropSelf is a cTestFixture
        Set psFunctionName to "EditorDropSelf"

        {Published=False}
        // ToDo: Dummy procedure. You need to fill it with a meaningful test and change 'Published=False' to 'Published=True'
        Procedure EditorDropSelf_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get EditorDropSelf of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oEditorNormalizeCase is a cTestFixture
        Set psFunctionName to "EditorNormalizeCase"

        {Published=True}
        Procedure EditorNormalizeCase_1
            String sLine sExpected
            String[] asData
            Boolean bChanged
            Move 'move iA TO iB' to asData[0]
            Move 'Move iA to iB' to sExpected  
            Get EditorNormalizeCase of ghoRefactorFuncLib (&asData) to bChanged
            If (bChanged = True) Begin
                Get Line of (phoEditor(ghoRefactorFuncLib)) 0 to sLine
            End
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oEditorReIndent is a cTestFixture
        Set psFunctionName to "EditorReIndent"

        {Published=True}
        Procedure EditorReIndent_1
            String sLine sExpected sParam
            Boolean bChanged bOK
            String[] asData
            Move "    If (Found) Begin"     to asData[0]
            Move "    Move False to Found"  to asData[1]
            Move "    End"                  to asData[2]
            Get EditorReIndent of ghoRefactorFuncLib (&asData) to bChanged
            If (bChanged = True) Begin
                Move (asData[0] = "If (Found) Begin") to bOK
                If (bOK) Begin
                    Move (asData[1] = "    Move False to Found") to bOK
                End                                                        
                If (bOK) Begin
                    Move (asData[2] = "End") to bOK
                End
            End
            Send Assert (bChanged and bOK)
        End_Procedure

    End_Object

    Object oRemoveEndComments is a cTestFixture
        Set psFunctionName to "RemoveEndComments"

        {Published=True}
        Procedure RemoveEndComments_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'End_Procedure   // This is a bla bla procedure' to sLine
            Move 'End_Procedure' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveEndComments of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveEndComments_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'End_Function   // This is an end function' to sLine
            Move 'End_Function' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveEndComments of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveEndComments_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'End_Class   // This class does bla bla bla' to sLine
            Move 'End_Class' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveEndComments of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure RemoveEndComments_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'End_Object   // This object does bla bla bla' to sLine
            Move 'End_Object' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveEndComments of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveMultipleBlankLines is a cTestFixture
        Set psFunctionName to "RemoveMultipleBlankLines"

        {Published=False}
        // Don't know if and how this should/could be tested?
        Procedure RemoveMultipleBlankLines_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveMultipleBlankLines of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveProjectObjectStructure is a cTestFixture
        Set psFunctionName to "RemoveProjectObjectStructure"

        {Published=False}
        // Don't know if and how this should/could be tested?
        Procedure RemoveProjectObjectStructure_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveProjectObjectStructure of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemovePropertyPrivate is a cTestFixture
        Set psFunctionName to "RemovePropertyPrivate"

        {Published=True}
        Procedure RemovePropertyPrivate_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Property Boolean pbState Private' to sLine
            Move 'Property Boolean pbState' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemovePropertyPrivate of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemovePropertyPublic is a cTestFixture
        Set psFunctionName to "RemovePropertyPublic"

        {Published=True}
        Procedure RemovePropertyPublic_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Property Boolean pbState Public' to sLine
            Move 'Property Boolean pbState' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemovePropertyPublic of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveSansSerif is a cTestFixture
        Set psFunctionName to "RemoveSansSerif"

        {Published=True}
        Procedure RemoveSansSerif_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Set TypeFace to "MS Sans serif"' to sLine
            Move '' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveSansSerif of ghoRefactorFuncLib (&sLine) to bChanged
            If (bChanged = True) Begin
                Move "" to sLine
            End
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveStudioGeneratedComments is a cTestFixture
        Set psFunctionName to "RemoveStudioGeneratedComments"

        {Published=False}
        // ToDo: Dummy procedure. You need to fill it with a meaningful test and change 'Published=False' to 'Published=True'
        Procedure RemoveStudioGeneratedComments_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveStudioGeneratedComments of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveTrailingSpaces is a cTestFixture
        Set psFunctionName to "RemoveTrailingSpaces"

        {Published=True}
        Procedure RemoveTrailingSpaces_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move True to Seqeof     ' to sLine
            Move 'Move True to Seqeof' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveTrailingSpaces of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRemoveUnusedLocals is a cTestFixture
        Set psFunctionName to "RemoveUnusedLocals"

        {Published=False}
        // Not sure how we should test this?
        Procedure RemoveUnusedLocals_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RemoveUnusedLocals of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oChangeCalcToMoveStatement is a cTestFixture
        Set psFunctionName to "ChangeCalcToMoveStatement"

        {Published=True}
        Procedure ChangeCalcToMoveStatement_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  Calc (iA * iB) to iC' to sLine
            Move '  Move (iA * iB) to iC' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCalcToMoveStatement of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeCalcToMoveStatement_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    MoveInt (iA * iB) to iC' to sLine
            Move '    Move (iA * iB) to iC' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCalcToMoveStatement of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeCalcToMoveStatement_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    MoveNum (nA * nB) to nC' to sLine
            Move '    Move (nA * nB) to nC' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCalcToMoveStatement of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeCalcToMoveStatement_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    MoveReal (rA * rB) to rC' to sLine
            Move '    Move (rA * rB) to rC' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCalcToMoveStatement of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

        {Published=True}
        Procedure ChangeCalcToMoveStatement_5
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    MoveStr ("Yes" * "and") to sC' to sLine
            Move '    Move ("Yes" * "and") to sC' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ChangeCalcToMoveStatement of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oReportUnusedSourceFiles is a cTestFixture
        Set psFunctionName to "ReportUnusedSourceFiles"

        {Published=False}
        // ToDo: Dummy procedure. You need to fill it with a meaningful test and change 'Published=False' to 'Published=True'
        Procedure ReportUnusedSourceFiles_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get ReportUnusedSourceFiles of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oRestylelDDOs is a cTestFixture
        Set psFunctionName to "RestylelDDOs"

        {Published=False}
        // ToDo: Dummy procedure. You need to fill it with a meaningful test and change 'Published=False' to 'Published=True'
        Procedure RestylelDDOs_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get RestylelDDOs of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oSplitInlineIfElseLine is a cTestFixture
        Set psFunctionName to "SplitInlineIfElseLine"

        {Published=False}
        // ToDo: Dummy procedure. You need to fill it with a meaningful test and change 'Published=False' to 'Published=True'
        Procedure SplitInlineIfElseLine_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '' to sLine
            Move ' ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Get SplitInlineIfElseLine of ghoRefactorFuncLib (&sLine) to bChanged
            Send AssertSAreEqual sExpected sLine
        End_Procedure

    End_Object

    Object oTokenizer is a cTestFixture
        Set psFunctionName to "Tokenizer"

        {Published=True}
        Procedure Tokenizer_1
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "This is a quoted string" to sVal' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bHasOverstrikeChars = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_2
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "Move 'Single quoted string' to sVal" to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bHasOverstrikeChars = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_3
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "Move 'Single quoted string' to sVal" to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Move "Move '++++++++++++++++++++' to sVal" to sExpected
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_4
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "This is a test string on multiple lines;'   to sLine
            Move 'Move "_______________________________________;'   to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine       to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_5
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "Double quoted string" to sVal' to sLine
            Move 'Move "____________________" to sVal' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_6
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '           //Move WindowIndex to FieldIndex' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsComment = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_7
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move aA to sB //This is an end comment' to sLine
            Move '//This is an end comment' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sEndComment sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_8
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '/* Move (iA / iB) to nC' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineComment = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_9
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '/* Move (iA / iB) to nC' to sLine
            Move '#######################' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_10
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '  Continuation of a DF23 multi-line comment' to sLine
            Move '###########################################' to sExpected
            Set pbIsInDF23MultiLineComment of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_11
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move (iA / iB) to nC */' to sLine
            Set pbIsInDF23MultiLineComment of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineComment = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_12
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '/* Move (iA / iB) to nC' to sLine
            Move '#######################' to sExpected
            Set pbIsInDF23MultiLineComment of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_13
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move (iA / iB) to nC */' to sLine
            Move '#######################' to sExpected
            Set pbIsInDF23MultiLineComment of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_14
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move (iA / iB) to nD' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineComment = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_15
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move CS_CRLF to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsBlank = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_16
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move "" to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsBlank = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_17
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '/MyPageName' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInImage = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_18
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '/*' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bLineIsReady = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_19
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '//  /*' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInImage = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_20
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Send Info_Box "This is a text string with an embedded semi-colon ;"' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bHasEndSemiColon = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_21
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "This is a source line with an ending semi-colon" ;' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bHasEndSemiColon = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_22
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If bOK ;  // Expand vDataType in the debugger' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bHasEndSemiColon = True)
        End_Procedure


        {Published=True}
        Procedure Tokenizer_23
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '@"Hello World' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineString = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_24
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '@"Hello World' to sLine
            Move '@"___________' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        // The pbIsInDF23MultiLineString property should now be = True (after the Tokenizer_IsMultiLineStringStart_1_1 test)
        {Published=True}
        Procedure Tokenizer_25
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    we will MOVE our warehouse to Lincoln next month.' to sLine
            Move     '_________________________________________________' to sExpected
            Set pbIsInDF23MultiLineString of ghoRefactorFuncLib to True
            Set pbIsOpenString            of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOverstrikeLine sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_26
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    we will MOVE our warehouse to Lincoln next month.' to sLine
            Set pbIsInDF23MultiLineString of ghoRefactorFuncLib to True
            Set pbIsOpenString            of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineString = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_27
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    we will MOVE our warehouse to Lincoln next month.' to sLine
            Set pbIsInDF23MultiLineString of ghoRefactorFuncLib to True
            Set pbIsOpenString            of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bLineIsReady = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_28
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Get SQLExecDirect of ghoSQLExecutor @SQL"""' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineString = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_29
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move @SQL""" SELECT * FROM Customer WHERE Customer.Name = "John Doe" """ to sSQL // End comment' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineString = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_30
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "@SQL" to sString // And an end comment' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineString = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_31
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "This is a string" to sText' to sLine
            Set pbIsInDF23MultiLineString of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineString = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_32
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '// This is a comment' to sLine
            Set pbIsInDF23MultiLineString of ghoRefactorFuncLib to True
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInDF23MultiLineString = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_33
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '// Function MyFunction String sA Returns Boolean ' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInFunction = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_34
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Function MyFunction String sA Returns Boolean ' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInFunction = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_35
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "Function MyFunction String sA Returns Boolean" to sMyString' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInFunction = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_36
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '// Procedure MyProc String sLine' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInProcedure = False)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_37
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Procedure MyProc String sLine' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInProcedure = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_38
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '#COMMAND WebPublishProcedure R .' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bIsInCommand = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_39
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '         Move aA to sB //This is an end comment' to sLine
            Move '         ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sIndentation sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_40
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move ('      //Move Windowindex to FieldIndex') to sLine
            Move '       ' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.bLineIsReady = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_41
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Indicate [Found] as (True = bTrue)' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.BooleanIndicator.bHasIndicateCommand = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_42
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If [Found] Indicate Err as (True = bTrue)' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.BooleanIndicator.bHasIndicateCommand = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_43
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Indicate [Found] as (True = bTrue)' to sLine
            Move 'Found' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.BooleanIndicator.FirstBoolean.sCode = sExpected)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_44
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '[Found] Move [Not Seqeof] to [Select]' to sLine
            Move 'Found' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.BooleanIndicator.FirstBoolean.sCode = sExpected)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_45
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move [Not Select] to [Found]' to sLine
            Move 'Found' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.BooleanIndicator.ToBoolean.sCode = sExpected)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_46
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Get phoHandle of (oMyObject(Current_Object)) to Found' to sLine
            Move '(oMyObject(Current_Object))' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.OfStatement.sCode sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_47
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Get psString of ghoApplication to sString' to sLine
            Move 'ghoApplication' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.OfStatement.sCode sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_48
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move (iA * iB) to iC' to sLine
            Move 'iC' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.ToStatement.sCode sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_49
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "New Label" to (Label(phoMainPanel(ghoApplication)))' to sLine
            Move '(Label(phoMainPanel(ghoApplication)))' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.ToStatement.sCode sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_50
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Move "New Label" to (Label(phoMainPanel(ghoApplication))) // Some comment' to sLine
            Move '(Label(phoMainPanel(ghoApplication)))' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.ToStatement.sCode sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_51
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If ((iA * iB > 10) + (iD + iE) > 100) Move (iA / iB) to nNumber // Some comment' to sLine
            Move 'Move' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.SecondLeftCommand.sCode sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_52
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If ((iA * iB > 10) + (iD + iE) > 100) Move (iA / iB) to nNumber // Some comment' to sLine
            Move 'Move' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.SecondLeftCommand.sCode sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_53
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If ((iA * iB > 10) + (iD + iE) > 100) Move (iA / iB) to nNumber // Some comment' to sLine
            Move '((iA * iB > 10) + (iD + iE) > 100)' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sLeftExpression1 sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_54
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'If ((iA * iB > 10) + (iD + iE) > 100) Move (iA / iB) to nNumber // Some comment' to sLine
            Move '(iA / iB)' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sLeftExpression2 sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_55
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'Get psAppSrcPath of (phoWorkspace(ghoApplication)) to sPath // Some comment' to sLine
            Move '(phoWorkspace(ghoApplication))' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sOfExpression sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_56
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move 'For iChar from 1 to (iPos - 1) // Some comment' to sLine
            Move '(iPos - 1)' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send AssertSAreEqual TokenizerData.sToExpression sExpected
        End_Procedure

        {Published=True}
        Procedure Tokenizer_57
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    If iA eq iB Move (Trim (FlexErrs.Error_Descr) * Trim (Flexerrs.Note)) to vData[iRow][2] // Name: ZipCode_City, Length: 100, Datatype: String' to sLine
            Move 'Move' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.SecondLeftCommand.sCode = sExpected)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_58
            String sLine sExpected
            Boolean bSame
            tTokenizer TokenizerData   
            tExpression[] aExpected
            
            Move 0  to aExpected[0].eExpressionMode
            Move 4  to aExpected[0].iStartPos
            Move 34 to aExpected[0].iLength
            Move "((iA * iB > 10) + (iD + iE) > 100)" to aExpected[0].sExpression

            Move 1  to aExpected[1].eExpressionMode
            Move 44 to aExpected[1].iStartPos
            Move 9  to aExpected[1].iLength
            Move "(iA / iB)" to aExpected[1].sExpression
            
            Move 'If ((iA * iB > 10) + (iD + iE) > 100) Move (iA / iB) to nNumber // Some comment' to sLine
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Move (IsSameArray(TokenizerData.aExpressions, aExpected)) to bSame
            Send Assert (bSame = True)
        End_Procedure

        {Published=True}
        Procedure Tokenizer_59
            String sLine sExpected
            Boolean bChanged
            tTokenizer TokenizerData
            Move '    If iA eq iB Move (Trim (FlexErrs.Error_Descr) * Trim (Flexerrs.Note)) to vData[iRow][2] // Name: ZipCode_City, Length: 100, Datatype: String' to sLine
            Move '    If iA eq iB Move (Trim (FlexErrs.Error_Descr) * Trim (Flexerrs.Note)) to vData[iRow][2] // Name: ZipCode_City, Length: 100, Datatype: String' to sExpected
            Get Tokenizer of ghoRefactorFuncLib sLine to TokenizerData
            Send Assert (TokenizerData.sLine = sExpected)
        End_Procedure

    End_Object

End_Object
